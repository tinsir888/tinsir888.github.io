<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>APS 重点复习课程之数据库系统 | TINSIR888's ZION</title><meta name="keywords" content="留学,德国,数据库系统,APS,APS 重点复习课程"><meta name="author" content="tinsir888"><meta name="copyright" content="tinsir888"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Overview Main Concept   Candidate Key   Primary Key  Primary Attribute    Foreign Key   The Structure of DBS  Internal Schema Schema External Schema  SQL Norm Form  1NF 2NF BCNF 3NF  ER Model Transac">
<meta property="og:type" content="article">
<meta property="og:title" content="APS 重点复习课程之数据库系统">
<meta property="og:url" content="https://tinsir888.github.io/posts/eded6502.html">
<meta property="og:site_name" content="TINSIR888&#39;s ZION">
<meta property="og:description" content="Overview Main Concept   Candidate Key   Primary Key  Primary Attribute    Foreign Key   The Structure of DBS  Internal Schema Schema External Schema  SQL Norm Form  1NF 2NF BCNF 3NF  ER Model Transac">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tinsir888.github.io/img/aps.png">
<meta property="article:published_time" content="2022-10-19T22:00:00.000Z">
<meta property="article:modified_time" content="2022-12-08T15:27:22.428Z">
<meta property="article:author" content="tinsir888">
<meta property="article:tag" content="留学">
<meta property="article:tag" content="德国">
<meta property="article:tag" content="数据库系统">
<meta property="article:tag" content="APS">
<meta property="article:tag" content="APS 重点复习课程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tinsir888.github.io/img/aps.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://tinsir888.github.io/posts/eded6502"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'APS 重点复习课程之数据库系统',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2022-12-08 16:27:22'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="TINSIR888's ZION" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">164</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">58</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">18</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/aps.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">TINSIR888's ZION</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">APS 重点复习课程之数据库系统</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-10-19T22:00:00.000Z" title="Created 2022-10-20 00:00:00">2022-10-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-12-08T15:27:22.428Z" title="Updated 2022-12-08 16:27:22">2022-12-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%95%99%E5%AD%A6%E7%94%B3%E8%AF%B7/">留学申请</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%95%99%E5%AD%A6%E7%94%B3%E8%AF%B7/APS-%E5%AE%A1%E6%A0%B8%E5%A4%8D%E4%B9%A0/">APS 审核复习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="APS 重点复习课程之数据库系统"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="overview"><a class="markdownIt-Anchor" href="#overview"></a> Overview</h1>
<p>Main Concept</p>
<ul>
<li>
<p>Candidate Key</p>
</li>
<li>
<p>Primary Key</p>
<ul>
<li>Primary Attribute</li>
</ul>
</li>
<li>
<p>Foreign Key</p>
</li>
</ul>
<p>The Structure of DBS</p>
<ul>
<li>Internal Schema</li>
<li>Schema</li>
<li>External Schema</li>
</ul>
<p>SQL</p>
<p>Norm Form</p>
<ul>
<li>1NF</li>
<li>2NF</li>
<li>BCNF</li>
<li>3NF</li>
</ul>
<p>ER Model</p>
<p>Transaction</p>
<ul>
<li>Atomic</li>
<li>Durability</li>
<li>Isolation</li>
<li>Consistency</li>
</ul>
<p>Failure and Recovery</p>
<ul>
<li>Transaction Failure: Backward Scan Log File</li>
<li>System Failure: Forward Scan Log File</li>
<li>Media Failure</li>
</ul>
<p>Concurrency Control</p>
<ul>
<li>Lost Update</li>
<li>Not-repeatable Read</li>
<li>Dirty Read</li>
</ul>
<p>Lock</p>
<ul>
<li>S-Lock</li>
<li>X-Lock</li>
</ul>
<p>Two Phase Locking</p>
<ul>
<li>in the former phase add locks only</li>
<li>in the later phase release locks only</li>
</ul>
<p>Deadlock</p>
<ul>
<li>Reasons</li>
<li>Solutions</li>
</ul>
<h1 id="main-concept"><a class="markdownIt-Anchor" href="#main-concept"></a> Main Concept</h1>
<p>DBMS: abbr. of Data Base Management System, is a piece of software designed to store and manage databases. z.B. DB2, Oracle, MySQL, MS SQL Server, …</p>
<p>DBS: abbr. of Data Base System = DBMS + data + application programs</p>
<p>Entity, Attribute, Key</p>
<p>Domain: a collection of the same data type</p>
<p>Entity type, Relationship</p>
<p>Super keys: set of attributes of table for which every row has distinct set of values</p>
<p>Candidate Key: The value of an attribute group can uniquely identify a tuple, but its subset cannot. aka “minimal” super keys.</p>
<p>Primary Key: One of the candidate key, chosen by DBA</p>
<p>Primary Attribute: the attributes of candidate key</p>
<p>Foreign Key</p>
<h1 id="the-structure-of-dbs"><a class="markdownIt-Anchor" href="#the-structure-of-dbs"></a> The Structure of DBS</h1>
<h2 id="3-level-schema-structure-of-the-db"><a class="markdownIt-Anchor" href="#3-level-schema-structure-of-the-db"></a> 3-level schema structure of the DB</h2>
<h3 id="internal-schema"><a class="markdownIt-Anchor" href="#internal-schema"></a> Internal Schema</h3>
<p>A description of the physical structure and storage of the data.</p>
<p>Methods included: Hash map or B+ Tree</p>
<h3 id="schema"><a class="markdownIt-Anchor" href="#schema"></a> Schema</h3>
<p>A description of the logical structure and characteristics of all data in the database, such as the type of data and the length of data, the relationships between data as well.</p>
<p>A specific value of schema is called instance.</p>
<h3 id="external-schema"><a class="markdownIt-Anchor" href="#external-schema"></a> External Schema</h3>
<p>A description of the logical structure and characteristics of the local data that users can see a database have a lots of external schema.</p>
<p>It’s the view of users, an external schema can be used by multiple applications.</p>
<p>It’s effective precaution of database security, a user can only see the data in the external schema while other data out of external schema is invisible.</p>
<h2 id="secondary-image-function-of-the-db"><a class="markdownIt-Anchor" href="#secondary-image-function-of-the-db"></a> Secondary Image Function of the DB</h2>
<h3 id="external-modemode-image"><a class="markdownIt-Anchor" href="#external-modemode-image"></a> External mode/mode image</h3>
<ul>
<li>When the schema is changed, we can adjust the external mode/mode image to let the external schema remain unchanged. Because the application is designed based on external mode, if external mode remain unchanged, then the applications don’t need any changes as well.</li>
<li>Each external mode have a image to the unique mode.</li>
<li>This kind of image ensure the logical independence between data and program.</li>
</ul>
<h3 id="modeinternal-mode-image"><a class="markdownIt-Anchor" href="#modeinternal-mode-image"></a> Mode/Internal mode image</h3>
<ul>
<li>When the internal schema is changed, we can adjust the internal mode/mode image to let the schema remain unchanged, thus the applications don’t need any change.</li>
<li>That ensure the physical independence between data and program.</li>
</ul>
<h2 id="why-3-level-schema"><a class="markdownIt-Anchor" href="#why-3-level-schema"></a> Why 3-level Schema</h2>
<ol>
<li>User can access the data without too much care about the storage and organization data.</li>
<li>Simplify the design of application, the independence between data and program ensure that.</li>
</ol>
<h1 id="sql"><a class="markdownIt-Anchor" href="#sql"></a> SQL</h1>
<h2 id="createdrop-schema"><a class="markdownIt-Anchor" href="#createdrop-schema"></a> Create/Drop Schema</h2>
<p>Create a schema can be seen as the definition of the namespace.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE SCHEMA XX Authorization &lt;usrname&gt;</span><br></pre></td></tr></table></figure>
<p>Drop schema:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP SCHEMA XX CASCADE | RESTRICT</span><br></pre></td></tr></table></figure>
<p>CASCADE: drop all the related objects of the schema as well</p>
<p>RESTRICT: It can be dropped only when there is no existed objects of this schema.</p>
<h2 id="table"><a class="markdownIt-Anchor" href="#table"></a> Table</h2>
<p>Create table:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE XX</span><br><span class="line">(</span><br><span class="line">    some attribute TYPE PRIMARY KEY ()</span><br><span class="line">    some attribute TYPE UNIQUE</span><br><span class="line">    cpno CHAR(4) CHECK (cpno IN (&#x27;one&#x27;,&#x27;two&#x27;))</span><br><span class="line">    FOREIGN KEY(cpno) REFERENCE course(cno)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>Only one PRIMARY KEY, several UNIQUE attributes.</li>
<li>No attribute of a PRIMARY KEY can ever be NULL in any tuple. But attributes declared UNIQUE may have NULL.</li>
</ul>
<p>Alter and drop table:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE Persons</span><br><span class="line">ALTER COLUMN Birthday Year#修改列名</span><br><span class="line">DROP COLUMN Year#删除列</span><br><span class="line"></span><br><span class="line">ALTER TABLE Persons ADD CONSTRAIN CK_AGE CHECK(SEX = 1 OR SEX = 0)#添加约束</span><br><span class="line"></span><br><span class="line">ALTER TABLE XX ADD Name type CONSTRAIN OF COLUMN</span><br><span class="line">ADD CONTRAIN OF TABLE</span><br></pre></td></tr></table></figure>
<h2 id="trigger"><a class="markdownIt-Anchor" href="#trigger"></a> Trigger</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER trigger_name trigger_time trigger_event ON tb_name FOR EACH ROW trigger_stmt</span><br></pre></td></tr></table></figure>
<p>trigger_name: name of trigger</p>
<p>trigger_time: time to trigger, <code>BEFORE</code> or <code>AFTER</code></p>
<p>trigger_event: incident to trigger, <code>INSERT</code>, <code>DELETE</code> or<code>UPDATE</code>.</p>
<p>tb_name: Name of table to set trigger on.</p>
<p>trigger_stmt: What does trigger do, can be a SQL instruction or multi-statement started after <code>BEGIN</code> and end before <code>END</code>.</p>
<p>There are 6 types of triggers in MySQL:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BEFORE INSERT</span><br><span class="line">BEFORE DELETE</span><br><span class="line">BEFORE UPDATE</span><br><span class="line">AFTER INSERT</span><br><span class="line">AFTER DELETE</span><br><span class="line">AFTER UPDATE</span><br></pre></td></tr></table></figure>
<h2 id="query"><a class="markdownIt-Anchor" href="#query"></a> Query</h2>
<h3 id="select-from-where"><a class="markdownIt-Anchor" href="#select-from-where"></a> select… from… where…</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT AttributeName</span><br><span class="line">FROM TableName</span><br><span class="line">WHERE X=XX | X LIKE XX | IN XX |</span><br></pre></td></tr></table></figure>
<h2 id="joint-query"><a class="markdownIt-Anchor" href="#joint-query"></a> Joint Query</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT student sno,sname</span><br><span class="line">FROM student, sc</span><br><span class="line">WHERE student.sno=sc.sno AND sc.cno=&#x27;2&#x27; AND sc.grade&gt;90</span><br></pre></td></tr></table></figure>
<h3 id="exists"><a class="markdownIt-Anchor" href="#exists"></a> exists</h3>
<p>z.B. Find name of employee in department which only have only one employee.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT empname FROM employee e1</span><br><span class="line">WHERE NOT EXISTS (SELECT * FROM employee WHERE deptno=e1.deptno AND empname&lt;&gt;e1.empname)</span><br></pre></td></tr></table></figure>
<h2 id="nested-query"><a class="markdownIt-Anchor" href="#nested-query"></a> Nested Query</h2>
<p>Nest a internal query inside the WHERE of external query.</p>
<h3 id="any-all"><a class="markdownIt-Anchor" href="#any-all"></a> any &amp; all</h3>
<p>Find the beers not sold for the lowest price.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT beer FROM sells WHERE price&gt;ANY(SELECT price FROM sells)</span><br></pre></td></tr></table></figure>
<ul>
<li>x = ANY is true if and only if x equals at least one tuple in the relation.</li>
<li>Similarly, = can be replaced by any comparison operator.</li>
<li>x &gt; ANY, means x is larger than at least one tuple in the relation.</li>
</ul>
<p>Find the beers sold for the highest price.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT beer FROM sells WHERE price&gt;=ANY(SELECT price FROM sells)</span><br></pre></td></tr></table></figure>
<ul>
<li>x &gt; ALL, means x is larger than any one tuple in the relation.</li>
</ul>
<h3 id="union-intersection-difference"><a class="markdownIt-Anchor" href="#union-intersection-difference"></a> union, intersection, difference</h3>
<p>Find the drinkers and beers such that the drinker likes the beer and frequents a bar that serves it.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(SELECT * FROM likes) INTERSECT (SELECT drink,beer FROM sells,frequents WHERE frequents.bar=sells.bar)</span><br></pre></td></tr></table></figure>
<h3 id="distinct"><a class="markdownIt-Anchor" href="#distinct"></a> distinct</h3>
<p>Find the different price for beers.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT price FROM sells</span><br></pre></td></tr></table></figure>
<h3 id="aggregations"><a class="markdownIt-Anchor" href="#aggregations"></a> aggregations</h3>
<p>sum, avg, min, max, count, count(*).</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT AVG(price)</span><br><span class="line">FROM sells</span><br><span class="line">WHERE beer=&#x27;bud&#x27;</span><br><span class="line"></span><br><span class="line">SELECT COUNT(DISTINCT price)</span><br><span class="line">FROM sells</span><br><span class="line">WHERE beer=&#x27;bud&#x27;</span><br></pre></td></tr></table></figure>
<h3 id="grouping"><a class="markdownIt-Anchor" href="#grouping"></a> grouping</h3>
<p>Given a table workson(empno, projectno, job, enterdate)</p>
<p>How many projects does each employee participate in?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT empno,COUNT(*)</span><br><span class="line">FROM workson</span><br><span class="line">GROUP BY empno;</span><br></pre></td></tr></table></figure>
<p>How many employees participate in each project?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT projectno,COUNT(*)</span><br><span class="line">FROM workson</span><br><span class="line">GROUP BY projectno;</span><br></pre></td></tr></table></figure>
<p>How many employees for each job?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT job,COUNT(*)</span><br><span class="line">FROM workson</span><br><span class="line">GROUP BY job;</span><br></pre></td></tr></table></figure>
<h3 id="having"><a class="markdownIt-Anchor" href="#having"></a> having</h3>
<p>HAVING clauses are selections on groups.</p>
<p>Find the average price of those beers that are either served in at least 3 bars or manufactured by Busch.</p>
<p>Beers(name(p-key),manf); Sells(bar(p-key), beer(p-key), price)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT beer,AVG(price)</span><br><span class="line">FROM Sells</span><br><span class="line">GROUP BY beer</span><br><span class="line">HAVING COUNT(*)&gt;=3 OR beer IN (SELECT name FROM beers WHERE manf=&#x27;Busch&#x27;)</span><br></pre></td></tr></table></figure>
<h2 id="sql-authorization"><a class="markdownIt-Anchor" href="#sql-authorization"></a> SQL Authorization</h2>
<h3 id="privileges"><a class="markdownIt-Anchor" href="#privileges"></a> Privileges</h3>
<p>Important privileges on a relation:</p>
<p>SELECT INSERT DELETE UPDATE</p>
<h3 id="grant-and-revoke"><a class="markdownIt-Anchor" href="#grant-and-revoke"></a> Grant and Revoke</h3>
<p>GRANT:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT &lt;list_of_privileges&gt; ON &lt;relation_or_object&gt; TO &lt;list_of_authorization_ID&gt;</span><br></pre></td></tr></table></figure>
<p>if you want the recipients to be able to pass the privileges to others, add:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WITH GRANT OPTION</span><br></pre></td></tr></table></figure>
<p>REVOKE:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REVOKE &lt;list_of_privileges&gt; ON &lt;relation_or_object&gt; FROM &lt;list_of_authorization_ID&gt;</span><br></pre></td></tr></table></figure>
<p>REVOKE OPTIONS:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CASCADE#any grants made by a revoke are also not in force.</span><br><span class="line">RESTRICT#if the privilege has been passed to others, the REVOKE fails as a warning that something else must be done to chase the privilege down.</span><br></pre></td></tr></table></figure>
<h3 id="grant-diagrams"><a class="markdownIt-Anchor" href="#grant-diagrams"></a> Grant Diagrams</h3>
<p>…</p>
<h1 id="norm-form"><a class="markdownIt-Anchor" href="#norm-form"></a> Norm Form</h1>
<h2 id="functional-dependency"><a class="markdownIt-Anchor" href="#functional-dependency"></a> Functional Dependency</h2>
<p>X, Y is the <strong>subset</strong> of the attribute set U.</p>
<p>If there are no such 2 tuples (X, Y), if every X have only one corresponding Y, then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>, aka Y functional depends on X.</p>
<p>Fully functional dependency:</p>
<ul>
<li>if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> and to every true subset of X named X’, we have <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>↛</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X&#x27;\nrightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">↛</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> then Y fully functional depends on X, remarked as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo><mover><mo><mo>→</mo></mo><mi>F</mi></mover></mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\stackrel{F}\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1452010000000001em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1452010000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.5668699999999998em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>.</li>
</ul>
<p>Partial functional dependency:</p>
<ul>
<li>if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> and Y is not fully functional depends on X, then Y partly depends on X, remarked as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo><mover><mo><mo>→</mo></mo><mi>P</mi></mover></mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\stackrel{P}\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1452010000000001em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1452010000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">→</span></span></span><span style="top:-3.5668699999999998em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>.</li>
</ul>
<p>Transitive functional dependency:</p>
<ul>
<li>if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>↛</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\nrightarrow X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">↛</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Y\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>, then Z transitive functional depends on X. remark as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo><mover><mo><mo>⟶</mo></mo><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi></mrow></mover></mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X\stackrel{transitive}\longrightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2836640000000001em;vertical-align:-0.011em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2726640000000002em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">⟶</span></span></span><span style="top:-3.7110000000000003em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li>
</ul>
<h2 id="relational-patterns-非常重要️"><a class="markdownIt-Anchor" href="#relational-patterns-非常重要️"></a> Relational Patterns​ ​非常​重要⚠️</h2>
<p>Schema design motivation:</p>
<ol>
<li>redundancy</li>
<li>inconsistency</li>
<li>update anomalies</li>
<li>deletion anomalies</li>
<li>insertion anomalies</li>
</ol>
<h3 id="1nf-first-normal-form"><a class="markdownIt-Anchor" href="#1nf-first-normal-form"></a> 1NF first normal form</h3>
<p>every attributes are inseparable.</p>
<h3 id="2nf-second-normal-form"><a class="markdownIt-Anchor" href="#2nf-second-normal-form"></a> 2NF second normal form</h3>
<p>Every non-primary attribute fully functionally depends on any candidate key.</p>
<h3 id="bcnf-boyce-codd-normal-form"><a class="markdownIt-Anchor" href="#bcnf-boyce-codd-normal-form"></a> BCNF Boyce Codd normal form</h3>
<p>A relation R is in BCNF iff:</p>
<ul>
<li>Whenever there is a nontrivial FD <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mo>→</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A_1,A_2,\cdots,A_n\rightarrow B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>. (nontrivial means A is not a member of set X s.t. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span>)</li>
<li>for R, it is the case that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{A_1,A_2,\cdots,A_n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> is a super-key for R.</li>
</ul>
<p>BCNF removes certain types of redundancy &amp; avoids info loss.</p>
<h3 id="3nf-third-normal-form"><a class="markdownIt-Anchor" href="#3nf-third-normal-form"></a> 3NF third normal form</h3>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> violates 3NF iff X is not a super-key and A is not prime.</p>
<p>z.B. FD: AB→C and C→B, we have keys AB and AC. Thus A, B and C are each prime. Although C→B violates BCNF, it doesn’t violate 3NF.</p>
<p>A table is in 3NF iff both of the following conditions hold:</p>
<ul>
<li>The <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Relation_(database)">relation</a> R (table) is in <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Second_normal_form">second normal form</a> (2NF).</li>
<li>Every non-prime attribute of R is non-transitively dependent on every key of R.</li>
</ul>
<h3 id="4nf-fourth-normal-form"><a class="markdownIt-Anchor" href="#4nf-fourth-normal-form"></a> 4NF fourth normal form</h3>
<p>Multivalued dependencies (MVD) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> is an assertion that if 2 tuples of a relation agree on all the attributes of X, then their components in the set of attributes Y may be swapped, and the result will be 2 tuples that are also in the relation.</p>
<p>Data redundancy.</p>
<p>z.B. Drinkers(name, addr, phones, beersLiked). 2 MVD in this: name→→phones, name →→beersLiked.</p>
<p>A relation R is in 4NF if whenever X→→Y is a <em>nontrivial</em> MVD, then X is a super-key.</p>
<p>nontrivial: Y is not a subset of X, and X &amp; Y are not, together, all the attributes.</p>
<h1 id="er-model"><a class="markdownIt-Anchor" href="#er-model"></a> ER Model</h1>
<p>Entity-Relationship Model</p>
<h2 id="er-diagram"><a class="markdownIt-Anchor" href="#er-diagram"></a> ER Diagram</h2>
<h3 id="relation-multiplicity"><a class="markdownIt-Anchor" href="#relation-multiplicity"></a> Relation Multiplicity</h3>
<ul>
<li>one - one: ←菱形→</li>
<li>many - one: —菱形→</li>
<li>many - many —菱形—</li>
</ul>
<h3 id="multiway-relationships"><a class="markdownIt-Anchor" href="#multiway-relationships"></a> Multiway Relationships</h3>
<p>Converting a multiway one into many binary ones.</p>
<h2 id="constraints"><a class="markdownIt-Anchor" href="#constraints"></a> Constraints</h2>
<p>Keys: unique identifier. z.B. social security number for a person</p>
<p>Referential integrity constraints: z.B. if you work for a company, it must exist in the database.</p>
<p>Domain constraints: z.B. people’s ages are not negative.</p>
<p>General constraints: all other constraints.</p>
<h2 id="design-principles"><a class="markdownIt-Anchor" href="#design-principles"></a> Design principles</h2>
<h3 id="be-faithful"><a class="markdownIt-Anchor" href="#be-faithful"></a> Be faithful</h3>
<p>Design should reflect ideas of the DB.</p>
<h3 id="avoid-redundancy"><a class="markdownIt-Anchor" href="#avoid-redundancy"></a> Avoid redundancy</h3>
<ul>
<li>Redundancy occurs when we say the same thing in two different ways.</li>
<li>Redundancy wastes space and <strong>encourage inconsistency</strong>.</li>
</ul>
<h3 id="entity-sets-vs-attributes"><a class="markdownIt-Anchor" href="#entity-sets-vs-attributes"></a> Entity Sets VS Attributes</h3>
<p>Don’t use an entity set when an attribute will do.</p>
<p>An entity set should satisfy at least one of the following:</p>
<ul>
<li>It has at least one non-key attribute.</li>
<li>It is the “many” in a many - one or many - many relationships.</li>
</ul>
<h3 id="limit-the-use-of-weak-entity-sets"><a class="markdownIt-Anchor" href="#limit-the-use-of-weak-entity-sets"></a> Limit the use of weak entity sets</h3>
<p>weak entity set: a weak entity set has one or more many - one relationships to other entity sets. <em>The key for a weak entity set is its own underlined attributes and the keys for the supporting entity sets.</em></p>
<p>Chain of Weakness</p>
<h2 id="translating-subclass-entities"><a class="markdownIt-Anchor" href="#translating-subclass-entities"></a> Translating Subclass Entities</h2>
<p>3 approaches:</p>
<ol>
<li>
<p>Object-oriented: each entity belongs to exactly one class; create relation for each class, with all its attributes.</p>
</li>
<li>
<p>ER style: create one relation for each entity set, with only the key attributes and attributes attached to that entity set; entity represented in all relations to whose entity set it belongs.</p>
</li>
<li>
<p>Use nulls: create one relation; entities have null in attributes that don’t belong to them.</p>
<p>space-wasting</p>
</li>
</ol>
<h2 id="integrity-constraints"><a class="markdownIt-Anchor" href="#integrity-constraints"></a> Integrity Constraints</h2>
<h3 id="entity-integrity"><a class="markdownIt-Anchor" href="#entity-integrity"></a> Entity Integrity</h3>
<p>Attribute of primary key can’t be NULL.</p>
<h3 id="referential-integrity"><a class="markdownIt-Anchor" href="#referential-integrity"></a> Referential Integrity</h3>
<p>It requires that if a value of one attribute (column) of a relation (table) references a value of another attribute (either in the same or a different relation), then the referenced value must exist.</p>
<h3 id="user-defined-integrity"><a class="markdownIt-Anchor" href="#user-defined-integrity"></a> User-defined Integrity</h3>
<p>User define which attributes should be UNIQUE or NOT NULL.</p>
<h1 id="transaction"><a class="markdownIt-Anchor" href="#transaction"></a> Transaction</h1>
<p>A sequence of operations, we can either accomplish all these operations or none of them.</p>
<h2 id="atomic"><a class="markdownIt-Anchor" href="#atomic"></a> Atomic</h2>
<p>Either all transaction are executed or none.</p>
<h2 id="durability"><a class="markdownIt-Anchor" href="#durability"></a> Durability</h2>
<p>Once after the commit of transactions, its operation to database should be permanently saved.</p>
<h2 id="isolation"><a class="markdownIt-Anchor" href="#isolation"></a> Isolation</h2>
<p>The execution of transactions won’t disturb each others.</p>
<h2 id="consistency"><a class="markdownIt-Anchor" href="#consistency"></a> Consistency</h2>
<p>The database can only contain the successfully executed transactions, otherwise will the database not in a consistent state.</p>
<p>z.B. After a bank transfer the total deposits should remain unchanged.</p>
<h1 id="failure-and-recovery"><a class="markdownIt-Anchor" href="#failure-and-recovery"></a> Failure and Recovery</h1>
<h2 id="3-failure"><a class="markdownIt-Anchor" href="#3-failure"></a> 3 Failure</h2>
<h3 id="transaction-failure-backward-scan-log-file"><a class="markdownIt-Anchor" href="#transaction-failure-backward-scan-log-file"></a> Transaction Failure: Backward Scan Log File</h3>
<p>The transaction doesn’t reach the commit or the rollback, then the database might not be in a consistent state, thereby we should undo the failed transaction without disturbing the other transactions.</p>
<h3 id="system-failure-forward-scan-log-file"><a class="markdownIt-Anchor" href="#system-failure-forward-scan-log-file"></a> System Failure: Forward Scan Log File</h3>
<p>The system corrupt and every transaction in the memory is interrupted, which means the transactions haven’t reach to the commit or rollback need to be undo and the committed transactions maybe still store in the data buffer and haven’t write to the physical database, these transactions need to be redone.</p>
<h3 id="media-failure"><a class="markdownIt-Anchor" href="#media-failure"></a> Media Failure</h3>
<p>The physical storage media corrupt, z.B. the disk is physical broken.</p>
<h2 id="log-file"><a class="markdownIt-Anchor" href="#log-file"></a> Log File</h2>
<p>Record the operation of every transaction, each log record consists of the begin transaction mark and the commit or rollback mark, the new value after update and the old value before update, as well as the ID of transaction.</p>
<ol>
<li>The registration order should strictly correspond to the order of execution.</li>
<li>Register on the log file first, then write to the database.</li>
</ol>
<h2 id="system-recovery-strategy"><a class="markdownIt-Anchor" href="#system-recovery-strategy"></a> System Recovery Strategy</h2>
<ol>
<li>
<p>The recovery of transaction failure:</p>
<p>Backward scan log file, undo the operation of the transaction, delete the insert, undo the update (write the value before update back to the database)</p>
</li>
<li>
<p>The recovery of system failure:</p>
<p>Forward scan log file, put finished process before into redo-list, unfinished process into undo-list.</p>
</li>
<li>
<p>The recovery of media failure:</p>
<p>Load the latest backup of database and the backup of log file, do the same thing as system failure.</p>
</li>
</ol>
<h1 id="concurrency-control"><a class="markdownIt-Anchor" href="#concurrency-control"></a> Concurrency Control</h1>
<p>In order to ensure the isolation and consistency we need concurrency<br />
control the concurrency can lead to following failures:</p>
<h2 id="lost-update"><a class="markdownIt-Anchor" href="#lost-update"></a> Lost Update</h2>
<p>Transaction A and B write the same data back to the database then the later update is lost.</p>
<h2 id="not-repeatable-read"><a class="markdownIt-Anchor" href="#not-repeatable-read"></a> Not-repeatable Read</h2>
<p>Transaction B update the data after transaction A have read it then the transaction A can’t reproduce the previous data.</p>
<h2 id="dirty-read"><a class="markdownIt-Anchor" href="#dirty-read"></a> Dirty Read</h2>
<p>Transaction A write a data back to the disk and the same time transaction B read the updated data, but transaction A is undo by some reason and the data recover to the original value.</p>
<h1 id="lock"><a class="markdownIt-Anchor" href="#lock"></a> Lock</h1>
<h2 id="shareexclusive-lock"><a class="markdownIt-Anchor" href="#shareexclusive-lock"></a> Share/Exclusive lock</h2>
<h3 id="s-lock"><a class="markdownIt-Anchor" href="#s-lock"></a> S-Lock</h3>
<p>aka share lock:</p>
<p>If transaction T gives a S lock to data A, then T can read A but can’t update A and the other transaction can only give S lock to A but not X locks.</p>
<h3 id="x-lock"><a class="markdownIt-Anchor" href="#x-lock"></a> X-Lock</h3>
<p>aka exclusive lock:</p>
<p>If transaction T gives a X lock to data A, then only T can read or update A and all the other transactions can’t give any lock to A.</p>
<h2 id="serializable-scheduling-method"><a class="markdownIt-Anchor" href="#serializable-scheduling-method"></a> Serializable Scheduling Method</h2>
<p>The concurrency of multiple transaction is correct only if the result is the same as the result of serial execution.</p>
<h3 id="precedence-graph"><a class="markdownIt-Anchor" href="#precedence-graph"></a> Precedence Graph</h3>
<p>Top sort…</p>
<h2 id="two-phase-locking-protocol-2pl"><a class="markdownIt-Anchor" href="#two-phase-locking-protocol-2pl"></a> Two Phase Locking Protocol (2PL)</h2>
<p>In order to ensure two transactions are serializable.</p>
<ul>
<li>
<p>in the former phase add locks only</p>
</li>
<li>
<p>in the later phase release locks only</p>
</li>
</ul>
<p>z.B. S-lock A S-lock B X-lock C Unlock A Unlock C Unlock B</p>
<h2 id="deadlock"><a class="markdownIt-Anchor" href="#deadlock"></a> Deadlock</h2>
<h3 id="reasons"><a class="markdownIt-Anchor" href="#reasons"></a> Reasons</h3>
<p>Refer to operating system</p>
<p>The condition of the deadlock</p>
<ol>
<li>mutual exclusion</li>
<li>Hold and wait or resource holding</li>
<li>no preemption 不剥夺条件</li>
<li>circular wait</li>
</ol>
<h3 id="solutions"><a class="markdownIt-Anchor" href="#solutions"></a> Solutions</h3>
<ol>
<li>Visit object at the same order</li>
<li>Avoid transactions between users.</li>
<li>Keep transactions short, at the same batch.</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://tinsir888.github.io">tinsir888</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://tinsir888.github.io/posts/eded6502.html">https://tinsir888.github.io/posts/eded6502.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%95%99%E5%AD%A6/">留学</a><a class="post-meta__tags" href="/tags/%E5%BE%B7%E5%9B%BD/">德国</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/">数据库系统</a><a class="post-meta__tags" href="/tags/APS/">APS</a><a class="post-meta__tags" href="/tags/APS-%E9%87%8D%E7%82%B9%E5%A4%8D%E4%B9%A0%E8%AF%BE%E7%A8%8B/">APS 重点复习课程</a></div><div class="post_share"><div class="social-share" data-image="/img/aps.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/9805f71d.html"><img class="prev-cover" src="/img/aps.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">APS 重点复习课程之人工智能导论</div></div></a></div><div class="next-post pull-right"><a href="/posts/efc05345.html"><img class="next-cover" src="/img/aps.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">APS 重点复习课程之算法导论</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/a37b98d7.html" title="APS 重点复习课程之软件工程"><img class="cover" src="/img/aps.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-28</div><div class="title">APS 重点复习课程之软件工程</div></div></a></div><div><a href="/posts/a942a1b8.html" title="APS 重点复习课程之深度学习及应用"><img class="cover" src="/img/aps.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-27</div><div class="title">APS 重点复习课程之深度学习及应用</div></div></a></div><div><a href="/posts/cad1b837.html" title="APS 重点复习课程之编译原理"><img class="cover" src="/img/aps.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-26</div><div class="title">APS 重点复习课程之编译原理</div></div></a></div><div><a href="/posts/28dbfae0.html" title="APS 重点复习课程之计算机网络"><img class="cover" src="/img/aps.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-25</div><div class="title">APS 重点复习课程之计算机网络</div></div></a></div><div><a href="/posts/551befad.html" title="APS 重点复习课程之汇编语言与逆向技术基础"><img class="cover" src="/img/aps.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-24</div><div class="title">APS 重点复习课程之汇编语言与逆向技术基础</div></div></a></div><div><a href="/posts/a346d5bd.html" title="APS 重点复习课程之计算机体系结构"><img class="cover" src="/img/aps.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-24</div><div class="title">APS 重点复习课程之计算机体系结构</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">tinsir888</div><div class="author-info__description">Willkommen bei tinsir888s Zion! :-)</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">164</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">58</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">18</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://www.github.com/tinsir888"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/tinsir888" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/smalltalk.odin@protonmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my personal Blog, I will update study notes and articles as I wish. ;-)</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#overview"><span class="toc-number">1.</span> <span class="toc-text"> Overview</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#main-concept"><span class="toc-number">2.</span> <span class="toc-text"> Main Concept</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#the-structure-of-dbs"><span class="toc-number">3.</span> <span class="toc-text"> The Structure of DBS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-level-schema-structure-of-the-db"><span class="toc-number">3.1.</span> <span class="toc-text"> 3-level schema structure of the DB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#internal-schema"><span class="toc-number">3.1.1.</span> <span class="toc-text"> Internal Schema</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#schema"><span class="toc-number">3.1.2.</span> <span class="toc-text"> Schema</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#external-schema"><span class="toc-number">3.1.3.</span> <span class="toc-text"> External Schema</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#secondary-image-function-of-the-db"><span class="toc-number">3.2.</span> <span class="toc-text"> Secondary Image Function of the DB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#external-modemode-image"><span class="toc-number">3.2.1.</span> <span class="toc-text"> External mode&#x2F;mode image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#modeinternal-mode-image"><span class="toc-number">3.2.2.</span> <span class="toc-text"> Mode&#x2F;Internal mode image</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#why-3-level-schema"><span class="toc-number">3.3.</span> <span class="toc-text"> Why 3-level Schema</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql"><span class="toc-number">4.</span> <span class="toc-text"> SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#createdrop-schema"><span class="toc-number">4.1.</span> <span class="toc-text"> Create&#x2F;Drop Schema</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#table"><span class="toc-number">4.2.</span> <span class="toc-text"> Table</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#trigger"><span class="toc-number">4.3.</span> <span class="toc-text"> Trigger</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#query"><span class="toc-number">4.4.</span> <span class="toc-text"> Query</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#select-from-where"><span class="toc-number">4.4.1.</span> <span class="toc-text"> select… from… where…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#joint-query"><span class="toc-number">4.5.</span> <span class="toc-text"> Joint Query</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#exists"><span class="toc-number">4.5.1.</span> <span class="toc-text"> exists</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nested-query"><span class="toc-number">4.6.</span> <span class="toc-text"> Nested Query</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#any-all"><span class="toc-number">4.6.1.</span> <span class="toc-text"> any &amp; all</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#union-intersection-difference"><span class="toc-number">4.6.2.</span> <span class="toc-text"> union, intersection, difference</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#distinct"><span class="toc-number">4.6.3.</span> <span class="toc-text"> distinct</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#aggregations"><span class="toc-number">4.6.4.</span> <span class="toc-text"> aggregations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grouping"><span class="toc-number">4.6.5.</span> <span class="toc-text"> grouping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#having"><span class="toc-number">4.6.6.</span> <span class="toc-text"> having</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql-authorization"><span class="toc-number">4.7.</span> <span class="toc-text"> SQL Authorization</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#privileges"><span class="toc-number">4.7.1.</span> <span class="toc-text"> Privileges</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grant-and-revoke"><span class="toc-number">4.7.2.</span> <span class="toc-text"> Grant and Revoke</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grant-diagrams"><span class="toc-number">4.7.3.</span> <span class="toc-text"> Grant Diagrams</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#norm-form"><span class="toc-number">5.</span> <span class="toc-text"> Norm Form</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#functional-dependency"><span class="toc-number">5.1.</span> <span class="toc-text"> Functional Dependency</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#relational-patterns-%E9%9D%9E%E5%B8%B8%E9%87%8D%E8%A6%81%EF%B8%8F"><span class="toc-number">5.2.</span> <span class="toc-text"> Relational Patterns​ ​非常​重要⚠️</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1nf-first-normal-form"><span class="toc-number">5.2.1.</span> <span class="toc-text"> 1NF first normal form</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2nf-second-normal-form"><span class="toc-number">5.2.2.</span> <span class="toc-text"> 2NF second normal form</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bcnf-boyce-codd-normal-form"><span class="toc-number">5.2.3.</span> <span class="toc-text"> BCNF Boyce Codd normal form</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3nf-third-normal-form"><span class="toc-number">5.2.4.</span> <span class="toc-text"> 3NF third normal form</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4nf-fourth-normal-form"><span class="toc-number">5.2.5.</span> <span class="toc-text"> 4NF fourth normal form</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#er-model"><span class="toc-number">6.</span> <span class="toc-text"> ER Model</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#er-diagram"><span class="toc-number">6.1.</span> <span class="toc-text"> ER Diagram</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#relation-multiplicity"><span class="toc-number">6.1.1.</span> <span class="toc-text"> Relation Multiplicity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multiway-relationships"><span class="toc-number">6.1.2.</span> <span class="toc-text"> Multiway Relationships</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#constraints"><span class="toc-number">6.2.</span> <span class="toc-text"> Constraints</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#design-principles"><span class="toc-number">6.3.</span> <span class="toc-text"> Design principles</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#be-faithful"><span class="toc-number">6.3.1.</span> <span class="toc-text"> Be faithful</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#avoid-redundancy"><span class="toc-number">6.3.2.</span> <span class="toc-text"> Avoid redundancy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#entity-sets-vs-attributes"><span class="toc-number">6.3.3.</span> <span class="toc-text"> Entity Sets VS Attributes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#limit-the-use-of-weak-entity-sets"><span class="toc-number">6.3.4.</span> <span class="toc-text"> Limit the use of weak entity sets</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#translating-subclass-entities"><span class="toc-number">6.4.</span> <span class="toc-text"> Translating Subclass Entities</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#integrity-constraints"><span class="toc-number">6.5.</span> <span class="toc-text"> Integrity Constraints</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#entity-integrity"><span class="toc-number">6.5.1.</span> <span class="toc-text"> Entity Integrity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#referential-integrity"><span class="toc-number">6.5.2.</span> <span class="toc-text"> Referential Integrity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#user-defined-integrity"><span class="toc-number">6.5.3.</span> <span class="toc-text"> User-defined Integrity</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#transaction"><span class="toc-number">7.</span> <span class="toc-text"> Transaction</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#atomic"><span class="toc-number">7.1.</span> <span class="toc-text"> Atomic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#durability"><span class="toc-number">7.2.</span> <span class="toc-text"> Durability</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#isolation"><span class="toc-number">7.3.</span> <span class="toc-text"> Isolation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#consistency"><span class="toc-number">7.4.</span> <span class="toc-text"> Consistency</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#failure-and-recovery"><span class="toc-number">8.</span> <span class="toc-text"> Failure and Recovery</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-failure"><span class="toc-number">8.1.</span> <span class="toc-text"> 3 Failure</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#transaction-failure-backward-scan-log-file"><span class="toc-number">8.1.1.</span> <span class="toc-text"> Transaction Failure: Backward Scan Log File</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#system-failure-forward-scan-log-file"><span class="toc-number">8.1.2.</span> <span class="toc-text"> System Failure: Forward Scan Log File</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#media-failure"><span class="toc-number">8.1.3.</span> <span class="toc-text"> Media Failure</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#log-file"><span class="toc-number">8.2.</span> <span class="toc-text"> Log File</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#system-recovery-strategy"><span class="toc-number">8.3.</span> <span class="toc-text"> System Recovery Strategy</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#concurrency-control"><span class="toc-number">9.</span> <span class="toc-text"> Concurrency Control</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#lost-update"><span class="toc-number">9.1.</span> <span class="toc-text"> Lost Update</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#not-repeatable-read"><span class="toc-number">9.2.</span> <span class="toc-text"> Not-repeatable Read</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dirty-read"><span class="toc-number">9.3.</span> <span class="toc-text"> Dirty Read</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lock"><span class="toc-number">10.</span> <span class="toc-text"> Lock</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#shareexclusive-lock"><span class="toc-number">10.1.</span> <span class="toc-text"> Share&#x2F;Exclusive lock</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#s-lock"><span class="toc-number">10.1.1.</span> <span class="toc-text"> S-Lock</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x-lock"><span class="toc-number">10.1.2.</span> <span class="toc-text"> X-Lock</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#serializable-scheduling-method"><span class="toc-number">10.2.</span> <span class="toc-text"> Serializable Scheduling Method</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#precedence-graph"><span class="toc-number">10.2.1.</span> <span class="toc-text"> Precedence Graph</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#two-phase-locking-protocol-2pl"><span class="toc-number">10.3.</span> <span class="toc-text"> Two Phase Locking Protocol (2PL)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#deadlock"><span class="toc-number">10.4.</span> <span class="toc-text"> Deadlock</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reasons"><span class="toc-number">10.4.1.</span> <span class="toc-text"> Reasons</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solutions"><span class="toc-number">10.4.2.</span> <span class="toc-text"> Solutions</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/7151c568.html" title="计算机视觉 W40 Training ConvNet (1)"><img src="/img/AUcv.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机视觉 W40 Training ConvNet (1)"/></a><div class="content"><a class="title" href="/posts/7151c568.html" title="计算机视觉 W40 Training ConvNet (1)">计算机视觉 W40 Training ConvNet (1)</a><time datetime="2023-10-01T22:00:00.000Z" title="Created 2023-10-02 00:00:00">2023-10-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ec43f770.html" title="算法博弈论 W40 Simple Near-Optimal Auctions"><img src="/img/AUagt.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="算法博弈论 W40 Simple Near-Optimal Auctions"/></a><div class="content"><a class="title" href="/posts/ec43f770.html" title="算法博弈论 W40 Simple Near-Optimal Auctions">算法博弈论 W40 Simple Near-Optimal Auctions</a><time datetime="2023-10-01T22:00:00.000Z" title="Created 2023-10-02 00:00:00">2023-10-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a44185d3.html" title="计算几何 W39 Introduction to Computational Geometry"><img src="/img/AUcg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算几何 W39 Introduction to Computational Geometry"/></a><div class="content"><a class="title" href="/posts/a44185d3.html" title="计算几何 W39 Introduction to Computational Geometry">计算几何 W39 Introduction to Computational Geometry</a><time datetime="2023-09-27T22:00:00.000Z" title="Created 2023-09-28 00:00:00">2023-09-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9083d0c1.html" title="计算机视觉 W39 Backpropagation"><img src="/img/AUcv.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机视觉 W39 Backpropagation"/></a><div class="content"><a class="title" href="/posts/9083d0c1.html" title="计算机视觉 W39 Backpropagation">计算机视觉 W39 Backpropagation</a><time datetime="2023-09-24T22:00:00.000Z" title="Created 2023-09-25 00:00:00">2023-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/307ec244.html" title="算法博弈论 W39 Revenue-maximizing auctions"><img src="/img/AUagt.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="算法博弈论 W39 Revenue-maximizing auctions"/></a><div class="content"><a class="title" href="/posts/307ec244.html" title="算法博弈论 W39 Revenue-maximizing auctions">算法博弈论 W39 Revenue-maximizing auctions</a><time datetime="2023-09-24T22:00:00.000Z" title="Created 2023-09-25 00:00:00">2023-09-25</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/aps.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By tinsir888</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://npm.elemecdn.com/hexo-butterfly-clock/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_injector_config();
  }
  </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax src="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>